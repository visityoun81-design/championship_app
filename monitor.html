<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAMPIONSHIP 2026 - 실시간 전광판</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Noto+Sans+KR:wght@900&display=swap" rel="stylesheet">
    <style>
        body { 
            margin: 0; 
            background: radial-gradient(circle at top, #1e1b4b, #020617);
            color: #fff; 
            font-family: 'Noto Sans KR', sans-serif; 
            overflow-y: auto;
        }
        .monitor-container { 
            min-height: 100vh; display: flex; flex-direction: column; 
            align-items: center; padding: 40px 20px; 
            box-sizing: border-box; 
        }
        .title { 
            font-family: 'Orbitron'; font-size: 3.5rem; 
            background: linear-gradient(to right, #d8b4fe, #a855f7);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(168, 85, 247, 0.4); 
            margin-bottom: 50px; letter-spacing: 12px; font-weight: 900;
        }
        .rank-board { 
            width: 100%; max-width: 1700px; 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 25px 18px; 
        }
        .rank-item { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1); 
            padding: 20px 15px; 
            border-radius: 20px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
        }
        .rank-num { 
            font-family: 'Orbitron', sans-serif; font-size: 1.3rem; font-weight: 900; 
            width: 48px; height: 48px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            color: #fff; background: #334155; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            flex-shrink: 0;
        }
        .medal-1 { background: linear-gradient(135deg, #ffd700, #b8860b) !important; color: #000 !important; border: 2px solid #fff; box-shadow: 0 0 15px #ffd700; }
        .medal-2 { background: linear-gradient(135deg, #ff85a2, #d6336c) !important; border: 2px solid #fff; }
        .medal-3 { background: linear-gradient(135deg, #4ea8de, #0077b6) !important; border: 2px solid #fff; }
        .medal-4 { background: linear-gradient(135deg, #9d4edd, #5a189a) !important; border: 2px solid #fff; }
        .medal-5 { background: linear-gradient(135deg, #ff9100, #ff6d00) !important; border: 2px solid #fff; }

        .info-wrap { display: flex; align-items: center; justify-content: flex-end; flex-grow: 1; gap: 12px; overflow: hidden; }
        .user-name { font-size: 1.4rem; font-weight: 900; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .user-score { font-family: 'Orbitron'; font-size: 1.8rem; color: #4ade80; min-width: 60px; text-align: right; }
        .is-playing { animation: pulse-glow 1.2s infinite; border: 2px solid #a855f7 !important; background: rgba(168, 85, 247, 0.15) !important; }
        @keyframes pulse-glow { 0% { box-shadow: 0 0 5px #a855f7; } 50% { box-shadow: 0 0 25px #a855f7; } 100% { box-shadow: 0 0 5px #a855f7; } }
    </style>
</head>
<body>
    <div class="monitor-container">
        <div class="title">LIVE CHAMPIONSHIP</div>
        <div id="rank-board" class="rank-board"></div>
    </div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
    // [1] Firebase 설정 (index와 동일하게 채워주세요)
  const firebaseConfig = {
    apiKey: "AIzaSyCbhFq8vcLem8DoMdlsXpC-ZRYELhJSFHU",
    authDomain: "championship-8f923.firebaseapp.com",
    databaseURL: "https://championship-8f923-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "championship-8f923",
    storageBucket: "championship-8f923.firebasestorage.app",
    messagingSenderId: "118704807417",
    appId: "1:118704807417:web:b1cacb9636d51a38d67128",
    measurementId: "G-KLHCC95R2C"
  };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    var db = firebase.database();

    // [2] 현재 보고 싶은 과목 설정 (예: 암산챔피언)
    var currentSubject = 'rank_championship'; 

    // [3] 실시간 순위 감시 및 그리기
    function startMonitor() {
        db.ref('rankings/' + currentSubject).on('value', function(snapshot) {
            var data = snapshot.val() || {};
            var rankArray = [];
            
            for(var id in data) {
                rankArray.push(data[id]);
            }

            // 정렬 로직: 점수 높은 순 -> 남은 시간 많은 순
            rankArray.sort(function(a, b) {
                if (b.score !== a.score) return b.score - a.score;
                return b.timeLeft - a.timeLeft;
            });

            renderBoard(rankArray); // 기존에 있던 전광판 그리기 함수 호출
        });
    }
// [4] ★ 새로 추가된 화면 그리기 함수 (이게 없어서 안 나왔던 거예요!) ★
    function renderBoard(rankArray) {
        var board = document.getElementById('rank-board');
        var html = "";
        
        // 상위 50명까지만 표시 (필요시 조정 가능)
        for(var i = 0; i < Math.min(rankArray.length, 50); i++) {
            var r = rankArray[i];
            var rankNum = i + 1;
            
            // 메달 및 효과 클래스 설정
            var medalClass = rankNum <= 5 ? "medal-" + rankNum : "";
            var playingClass = r.isPlaying ? "is-playing" : "";
            
            html += `
                <div class="rank-item ${playingClass}">
                    <div class="rank-num ${medalClass}">${rankNum}</div>
                    <div class="info-wrap">
                        <div class="user-name">${r.name}</div>
                        <div class="user-score">${r.score}</div>
                    </div>
                </div>
            `;
        }
        board.innerHTML = html;
    }


    // 과목 변경 함수 (버튼 클릭 시)
    function changeSubject(subKey) {
        currentSubject = subKey;
        startMonitor(); // 다시 감시 시작
    }

    window.onload = startMonitor;
</script>
</body>
</html>
