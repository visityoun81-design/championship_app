<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAMPIONSHIP 2026 - ì‹¤ì‹œê°„ ì „ê´‘íŒ</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Noto+Sans+KR:wght@900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        body { 
            margin: 0; 
            background: radial-gradient(circle at top, #1e1b4b, #020617);
            color: #fff; 
            font-family: 'Noto Sans KR', sans-serif; 
            overflow-y: auto;
        }
        
  /* ê°€ë¡œëª¨ë“œ ë° ëŒ€í™”ë©´ ìµœì í™” */
.monitor-container { 
    min-height: 100vh; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    /* ìƒë‹¨ íŒ¨ë”©ì„ 40pxì—ì„œ 15pxë¡œ ì¤„ì„ */
    padding: 15px 10px; 
    box-sizing: border-box; 
}

.title { 
    font-family: 'Orbitron'; 
    /* ê¸€ì í¬ê¸°ë¥¼ 3.5remì—ì„œ 2.1remìœ¼ë¡œ ì¶•ì†Œ */
    font-size: 2.1rem; 
    background: linear-gradient(to right, #d8b4fe, #a855f7);
    -webkit-background-clip: text; 
    -webkit-text-fill-color: transparent;
    /* ì•„ë˜ìª½ ë§ˆì§„ì„ 50pxì—ì„œ 15pxë¡œ ëŒ€í­ ì¶•ì†Œ */
    margin-bottom: 5px; 
    letter-spacing: 8px; 
    font-weight: 900;
}

/* í˜„ì¬ ì„ íƒëœ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.active-league {
    border: 2px solid white !important;
    box-shadow: 0 0 15px white !important;
    transform: scale(1.05);
    filter: brightness(1.2);
}

        .rank-board { 
            width: 100%; max-width: 1700px; 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 25px 18px; 
        }


.rank-item { 
    background: rgba(255, 255, 255, 0.05); 
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1); 
    padding: 6px 15px; /* ë†’ì´ë¥¼ ë” ì¤„ì˜€ìŠµë‹ˆë‹¤ */
    border-radius: 12px; 
    display: flex; 
    align-items: center; 
    /* justify-content: space-between; ëŒ€ì‹  ê°€ë¡œë¡œ ì­‰ ë‚˜ì—´í•˜ë„ë¡ ë³€ê²½ */
    gap: 15px; 
    margin-bottom: 4px;
}

.info-wrap { 
    display: flex; 
    align-items: center; 
    justify-content: center; /* [í•µì‹¬] ì¤‘ì•™ ì •ë ¬ */
    flex-grow: 1; 
    gap: 20px; /* ì´ë¦„ê³¼ ì ìˆ˜ ì‚¬ì´ì˜ ê°„ê²© */
}

.user-name { 
    font-size: 1.1rem; 
    font-weight: 700; 
    text-align: center; /* ì´ë¦„ í…ìŠ¤íŠ¸ ìì²´ ì¤‘ì•™ ì •ë ¬ */
}

.user-score { 
    font-family: 'Orbitron'; 
    font-size: 1.4rem; 
    color: #4ade80; 
    font-weight: 900;
}


/* ì´ë¦„ê³¼ ì ìˆ˜ í…ìŠ¤íŠ¸ í¬ê¸° ë¯¸ì„¸ ì¡°ì • */
.user-name { font-size: 1.1rem; font-weight: 700; }
.user-score { font-size: 1.4rem; font-weight: 900; }


.rank-num { 
    position: relative; /* â˜… ì•„ì´ì½˜ ìœ„ì¹˜ì˜ ê¸°ì¤€ì  - í•„ìˆ˜! */
    font-family: 'Orbitron', sans-serif; 
    font-size: 1rem; 
    width: 34px; 
    height: 34px; 
    border-radius: 50%; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    flex-shrink: 0;
    font-weight: 900;
    z-index: 5; /* ì•„ì´ì½˜ì´ ìœ„ë¡œ ì˜¬ë¼ì˜¤ê²Œ í•¨ */
}

.rank-icon {
    position: absolute;
    top: -16px; /* ìˆ«ì ì› ìœ„ë¡œ ì‚´ì§ ë„ì›€ */
    left: 50%;
    transform: translateX(-50%);
    font-size: 1.3rem; /* ì•„ì´ì½˜ í¬ê¸° */
    pointer-events: none;
}

        .medal-1 { background: linear-gradient(135deg, #ffd700, #b8860b) !important; color: #000 !important; border: 2px solid #fff; box-shadow: 0 0 15px #ffd700; }
        .medal-2 { background: linear-gradient(135deg, #ff85a2, #d6336c) !important; border: 2px solid #fff; }
        .medal-3 { background: linear-gradient(135deg, #4ea8de, #0077b6) !important; border: 2px solid #fff; }
        .medal-4 { background: linear-gradient(135deg, #9d4edd, #5a189a) !important; border: 2px solid #fff; }
        .medal-5 { background: linear-gradient(135deg, #ff9100, #ff6d00) !important; border: 2px solid #fff; }

        .info-wrap { display: flex; align-items: center; justify-content: flex-end; flex-grow: 1; gap: 12px; overflow: hidden; }
        .user-name { font-size: 1.4rem; font-weight: 900; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .user-score { font-family: 'Orbitron'; font-size: 1.8rem; color: #4ade80; min-width: 60px; text-align: right; }
        .is-playing { animation: pulse-glow 1.2s infinite; border: 2px solid #a855f7 !important; background: rgba(168, 85, 247, 0.15) !important; }
        @keyframes pulse-glow { 0% { box-shadow: 0 0 5px #a855f7; } 50% { box-shadow: 0 0 25px #a855f7; } 100% { box-shadow: 0 0 5px #a855f7; } }

.rank-board-column {
    display: flex;
    flex-direction: column;
    gap: 5px;
    background: rgba(255, 255, 255, 0.02);
    padding: 10px;
    border-radius: 15px;
    /* ê°€ë¡œëª¨ë“œì—ì„œ ë†’ì´ë¥¼ ê½‰ ì±„ìš°ë„ë¡ ì„¤ì • */
    height: calc(100vh - 180px); 
    overflow-y: auto; /* ì¸ì› ë§ì•„ì§€ë©´ ì—¬ê¸°ì„œ ìŠ¤í¬ë¡¤ ë°œìƒ */
    scrollbar-width: thin; /* ìŠ¤í¬ë¡¤ë°” ë‘ê»˜ ì¡°ì ˆ (íŒŒì´ì–´í­ìŠ¤) */
}

/* í¬ë¡¬/ì‚¬íŒŒë¦¬ ìŠ¤í¬ë¡¤ë°” ë””ìì¸ */
.rank-board-column::-webkit-scrollbar {
    width: 5px;
}
.rank-board-column::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
}

/* ê¸€ì í¬ê¸° ìë™ ì¡°ì ˆ (ê°€ë¡œëª¨ë“œ ëŒ€ì‘) */
@media (max-height: 500px) {
    .title { font-size: 2rem !important; margin-bottom: 15px !important; }
    .user-name { font-size: 0.9rem !important; }
    .user-score { font-size: 1.1rem !important; }
    .rank-num { width: 30px !important; height: 30px !important; font-size: 0.8rem !important; }
}
/* ê¸°ì¡´ rank-item ìŠ¤íƒ€ì¼ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë˜ ë„ˆë¹„ë¥¼ 100%ë¡œ ì„¤ì • */
.rank-item {
    width: 100% !important;
    box-sizing: border-box;
}

/* 1ìœ„ ê°•ì¡° ì• ë‹ˆë©”ì´ì…˜ */
@keyframes gold-glow {
    0% { box-shadow: 0 0 5px #ffd700; transform: scale(1); }
    50% { box-shadow: 0 0 40px #ffd700; transform: scale(1.05); }
    100% { box-shadow: 0 0 5px #ffd700; transform: scale(1); }
}
.first-place-new {
    animation: gold-glow 1s ease-in-out 3; /* 3ë²ˆ ë²ˆì©ì„ */
    border: 3px solid #ffd700 !important;
    background: rgba(255, 215, 0, 0.2) !important;
}


    </style>
</head>
<body>
<div class="monitor-container">
    <div class="title" id="main-title">LIVE CHAMPIONSHIP</div>
    
    <div id="button-group" style="margin-bottom: 20px; display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;">
        <button class="league-btn" id="btn-championship" onclick="showSingleLeague('rank_championship', 'CHAMPIONSHIP', this)" 
                style="padding: 6px 14px; font-size: 0.85rem; background: #a855f7; color: white; border: none; border-radius: 8px; font-weight: 900; cursor: pointer;">ğŸ† ì•”ì‚°ì±”í”¼ì–¸</button>
                
        <button class="league-btn" id="btn-add" onclick="showTripleLeague('add', this)" 
                style="padding: 6px 14px; font-size: 0.85rem; background: #4ea8de; color: white; border: none; border-radius: 8px; font-weight: 900; cursor: pointer;">â• ë§ì…ˆë¦¬ê·¸</button>
                
        <button class="league-btn" id="btn-mul" onclick="showTripleLeague('mul', this)" 
                style="padding: 6px 14px; font-size: 0.85rem; background: #fbbf24; color: black; border: none; border-radius: 8px; font-weight: 900; cursor: pointer;">âœ–ï¸ ê³±ì…ˆë¦¬ê·¸</button>
                
        <button class="league-btn" id="btn-div" onclick="showTripleLeague('div', this)" 
                style="padding: 6px 14px; font-size: 0.85rem; background: #f87171; color: white; border: none; border-radius: 8px; font-weight: 900; cursor: pointer;">â— ë‚˜ëˆ—ì…ˆë¦¬ê·¸</button>
<button onclick="makeFakeData()" style="display: none; padding: 8px 16px; font-size: 0.8rem; background: #444; color: #aaa; border: 1px dashed #666; border-radius: 10px; cursor: pointer;">ğŸ› ï¸ ìŠ¤í¬ë¡¤ í…ŒìŠ¤íŠ¸(ê°€ì§œë°ì´í„°)</button>
    </div>

    <div id="dynamic-board-area" style="width: 100%; max-width: 1800px;">
        </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
let lastFirstPlaceName = ""; // ì´ì „ 1ë“± ì´ë¦„ì„ ê¸°ì–µí•  ë³€ìˆ˜

    // [1] Firebase ì„¤ì • (indexì™€ ë™ì¼í•˜ê²Œ ì±„ì›Œì£¼ì„¸ìš”)
  const firebaseConfig = {
    apiKey: "AIzaSyCbhFq8vcLem8DoMdlsXpC-ZRYELhJSFHU",
    authDomain: "championship-8f923.firebaseapp.com",
    databaseURL: "https://championship-8f923-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "championship-8f923",
    storageBucket: "championship-8f923.firebasestorage.app",
    messagingSenderId: "118704807417",
    appId: "1:118704807417:web:b1cacb9636d51a38d67128",
    measurementId: "G-KLHCC95R2C"
  };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    var db = firebase.database();

    // [í•¨ìˆ˜ 1] ë‹¨ë… ê³¼ëª© í™”ë©´ (ì•”ì‚°ì±”í”¼ì–¸ ë“±)
    function showSingleLeague(subKey, title, btn) {
        activateButton(btn);
        document.getElementById('main-title').innerText = title;
        document.getElementById('main-title').innerText = title;
        const area = document.getElementById('dynamic-board-area');
        area.innerHTML = `<div id="board-single" class="rank-board"></div>`; // ê¸°ì¡´ ìŠ¤íƒ€ì¼ ì‚¬ìš©
        
        // ê¸°ì¡´ 5ì—´ ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ì„ ìœ„í•´ í´ë˜ìŠ¤ ì¡°ì •
        area.querySelector('#board-single').style.display = 'grid';
        area.querySelector('#board-single').style.gridTemplateColumns = 'repeat(5, 1fr)';

        db.ref('rankings/' + subKey).off(); // ì´ì „ ê°ì‹œ ì¤‘ë‹¨
        db.ref('rankings/' + subKey).on('value', function(snapshot) {
            const data = snapshot.val() || {};
            const arr = Object.values(data).sort((a, b) => b.score - a.score || (b.timeLeft || 0) - (a.timeLeft || 0));
            renderList('board-single', arr, 50); // ìƒìœ„ 50ëª…
        });
    }



    // [í•¨ìˆ˜ 2] 3ê°œ ê³¼ëª© ë™ì‹œ í™”ë©´ (ë§ì…ˆ, ê³±ì…ˆ, ë‚˜ëˆ—ì…ˆ)
    function showTripleLeague(type, btn) {
        activateButton(btn);
        const titles = { 'add': 'ADDITION LEAGUE', 'mul': 'MULTIPLICATION LEAGUE', 'div': 'DIVISION LEAGUE' };
        document.getElementById('main-title').innerText = titles[type];
        
        const area = document.getElementById('dynamic-board-area');
        area.innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                <div><h2 style="text-align:center; color:#4ade80;">BASE</h2><div id="b-1" class="rank-board-column"></div></div>
                <div><h2 style="text-align:center; color:#fbbf24;">MEDIUM</h2><div id="b-2" class="rank-board-column"></div></div>
                <div><h2 style="text-align:center; color:#f87171;">MASTER</h2><div id="b-3" class="rank-board-column"></div></div>
            </div>`;

        const subKeys = [ `rank_${type}_base`, `rank_${type}_medium`, `rank_${type}_master` ];
        
        subKeys.forEach((key, idx) => {
            db.ref('rankings/' + key).off();
            db.ref('rankings/' + key).on('value', function(snapshot) {
                const data = snapshot.val() || {};
                const arr = Object.values(data).sort((a, b) => b.score - a.score || (b.timeLeft || 0) - (a.timeLeft || 0));
                renderList('b-' + (idx+1), arr, 15); // ê° ì—´ë‹¹ 15ëª…
            });
        });
    }

// [í•¨ìˆ˜ 3] ê³µí†µ ê·¸ë¦¬ê¸° í•¨ìˆ˜
function renderList(targetId, arr) {
    const board = document.getElementById(targetId);
    if (!board) return;

    // 1. ë°ì´í„°ê°€ ì—†ì„ ë•Œ ì²˜ë¦¬
    if (!arr || arr.length === 0) {
        board.innerHTML = "<div style='text-align:center; color:#555; padding:20px;'>ì°¸ê°€ì ì—†ìŒ</div>";
        return; 
    }

    // 2. 1ë“± ë³€ê²½ ê°ì§€ ë° í­ì£½/ì†Œë¦¬ ì‹¤í–‰
    const currentFirstPlace = arr[0].name;
    if (lastFirstPlaceName !== "" && lastFirstPlaceName !== currentFirstPlace) {
        triggerWinnerEffect(); // í­ì£½ + 1ë“± ë³€ê²½ ì†Œë¦¬ ì‹¤í–‰
    }
    lastFirstPlaceName = currentFirstPlace;

    // 3. ë¦¬ìŠ¤íŠ¸ ê·¸ë¦¬ê¸° ì‹œì‘
    let html = "";
    for (let i = 0; i < arr.length; i++) {
        const r = arr[i];
        const rankNum = i + 1;
        
        // ìˆœìœ„ë³„ ì•„ì´ì½˜ ì„¤ì •
        let icon = "";
        if(rankNum === 1) icon = "ğŸ‘‘";
        else if(rankNum === 2) icon = "ğŸ¥ˆ";
        else if(rankNum === 3) icon = "ğŸ¥‰";
        else if(rankNum === 4) icon = "ğŸ…";
        else if(rankNum === 5) icon = "ğŸ–ï¸";

        const medalClass = rankNum <= 5 ? "medal-" + rankNum : "";
        const playingClass = r.isPlaying ? "is-playing" : "";
        
        // â˜… [ì—¬ê¸°ê°€ í•µì‹¬] 1ìœ„ì—ê²Œë§Œ íŠ¹ë³„ í´ë˜ìŠ¤(ë°˜ì§ì„ íš¨ê³¼) ì¶”ê°€
        const firstPlaceClass = (rankNum === 1) ? "first-place-new" : "";

        html += `
            <div class="rank-item ${playingClass} ${firstPlaceClass}">
                <div class="rank-num ${medalClass}">
                    <span class="rank-icon">${icon}</span>
                    ${rankNum}
                </div>
                <div class="info-wrap">
                    <div class="user-name">${r.name}</div>
                    <div class="user-score">${r.score}</div>
                </div>
            </div>`;
    }
    board.innerHTML = html;
}
// [í­ì£½ íš¨ê³¼ í•¨ìˆ˜]
function triggerWinnerEffect() {
// [ì¶”ê°€] ì†Œë¦¬ ì¬ìƒ!
    playWinnerSound();

    // ì¤‘ì•™ì—ì„œ í„°ì§€ëŠ” í­ì£½
    confetti({
        particleCount: 150,
        spread: 70,
        origin: { y: 0.6 },
        colors: ['#ffd700', '#ffffff', '#ff85a2']
    });
    
    // ì™¼ìª½ì—ì„œ ì˜ëŠ” í­ì£½
    confetti({
        particleCount: 80,
        angle: 60,
        spread: 55,
        origin: { x: 0 }
    });
    
    // ì˜¤ë¥¸ìª½ì—ì„œ ì˜ëŠ” í­ì£½
    confetti({
        particleCount: 80,
        angle: 120,
        spread: 55,
        origin: { x: 1 }
    });
}

// [í­ì£½ ì†Œë¦¬ í•¨ìˆ˜]
function playWinnerSound() {
    try {
        // ë°©ë²• 1: ê²€ì¦ëœ ë°•ìˆ˜ ì†Œë¦¬ (ìœ„í‚¤ë¯¸ë””ì–´ ê³µê°œ ì†ŒìŠ¤ - ì•„ì£¼ ì•ˆì •ì ì„)
        const audio = new Audio('https://upload.wikimedia.org/wikipedia/commons/3/3f/Clapping_Hand.wav');
        audio.volume = 0.7;
        
        const playPromise = audio.play();
        
        if (playPromise !== undefined) {
            playPromise.catch(error => {
                // ë°©ë²• 2: ë§Œì•½ ìœ„ ì†Œë¦¬ê°€ ì°¨ë‹¨ë˜ë©´, ì§ì ‘ ì „ììŒì„ ìƒì„±í•¨ (ì¹˜íŠ¸í‚¤)
                playBeepSound();
            });
        }
    } catch (e) {
        playBeepSound();
    }
}



// ë¸Œë¼ìš°ì €ê°€ ì§ì ‘ ì†Œë¦¬ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” í•¨ìˆ˜ (ì ˆëŒ€ ì‹¤íŒ¨ ì—†ìŒ)
function playBeepSound() {
    const context = new (window.AudioContext || window.webkitAudioContext)();
    const oscillator = context.createOscillator();
    const gainNode = context.createGain();

    oscillator.type = 'sine'; // ë¶€ë“œëŸ¬ìš´ ì†Œë¦¬
    oscillator.frequency.setValueAtTime(523.25, context.currentTime); // 'ë„' ìŒê³„
    oscillator.frequency.exponentialRampToValueAtTime(1046.50, context.currentTime + 0.3); // ìœ„ë¡œ ì†ŸëŠ” ì†Œë¦¬

    gainNode.gain.setValueAtTime(0.1, context.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.3);

    oscillator.connect(gainNode);
    gainNode.connect(context.destination);

    oscillator.start();
    oscillator.stop(context.currentTime + 0.3);
}


// ì²˜ìŒ ë¡œë“œë  ë•Œ ë§ì…ˆ ë²„íŠ¼ì— ë¶ˆì´ ë“¤ì–´ì˜¤ê²Œ ì„¤ì •
window.onload = function() {
    const defaultBtn = document.getElementById('btn-add');
    showTripleLeague('add', defaultBtn);
};



// [í…ŒìŠ¤íŠ¸ í•¨ìˆ˜] í•„ìš”í•œ ë•Œë§Œ ì£¼ì„ì„ í’€ì–´ì„œ ì“°ì„¸ìš”.
function makeFakeData() {
    const targets = ['b-1', 'b-2', 'b-3', 'board-single'];
    targets.forEach(targetId => {
        const board = document.getElementById(targetId);
        if(!board) return;
        
        let fakeArray = [];
        for(let i = 1; i <= 50; i++) {
            fakeArray.push({
                name: "í…ŒìŠ¤íŠ¸ìœ ì €" + i,
                score: Math.floor(Math.random() * 100),
                isPlaying: i % 10 === 0
            });
        }
        fakeArray.sort((a, b) => b.score - a.score);
        renderList(targetId, fakeArray);
    });
    alert("50ëª…ì˜ ê°€ì§œ ë°ì´í„°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
}

// --- ì•„ë˜ëŠ” ë²„íŠ¼ ë¶ˆë¹›ê³¼ ì†Œë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” í•„ìˆ˜ í•¨ìˆ˜ë“¤ì…ë‹ˆë‹¤ ---

function activateButton(targetBtn) {
    playClickSound(); // ë”¸ê¹ ì†Œë¦¬
    
    // ëª¨ë“  ë²„íŠ¼ ë¶ˆ ë„ê¸°
    document.querySelectorAll('.league-btn').forEach(btn => {
        btn.classList.remove('active-league');
    });
    
    // ì„ íƒí•œ ë²„íŠ¼ ë¶ˆ ì¼œê¸°
    if(targetBtn) targetBtn.classList.add('active-league');
}

function playClickSound() {
    const context = new (window.AudioContext || window.webkitAudioContext)();
    const oscillator = context.createOscillator();
    const gainNode = context.createGain();
    oscillator.type = 'sine';
    oscillator.frequency.setValueAtTime(800, context.currentTime);
    gainNode.gain.setValueAtTime(0.05, context.currentTime);
    oscillator.connect(gainNode);
    gainNode.connect(context.destination);
    oscillator.start();
    oscillator.stop(context.currentTime + 0.05);
}


</script>
</body>
</html>
